{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref } from 'vue';\nimport axios from 'axios';\nimport { useRouter } from 'vue-router';\nimport { ElForm, ElFormItem, ElInput, ElButton, ElMessage } from 'element-plus';\nexport default {\n  __name: 'loginComponent',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const userId = ref('');\n    const password = ref('');\n    const login = async () => {\n      try {\n        if (!userId.value || !password.value) {\n          ElMessage.error('请输入账号和密码');\n          return;\n        }\n\n        // 打印请求数据\n        console.log('发送登录请求:', {\n          userId: userId.value,\n          password: password.value\n        });\n        const response = await axios({\n          method: 'post',\n          url: 'http://localhost:8080/elm_servlet_war_exploded/login',\n          data: {\n            userId: userId.value,\n            password: password.value\n          },\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n\n        // 打印完整响应\n        console.log('收到响应:', {\n          status: response.status,\n          statusText: response.statusText,\n          headers: response.headers,\n          data: response.data\n        });\n\n        // 检查响应数据结构\n        if (response.data && typeof response.data === 'object') {\n          console.log('响应数据结构验证:', {\n            hasSuccess: 'success' in response.data,\n            hasMessage: 'message' in response.data,\n            hasData: 'data' in response.data,\n            successType: typeof response.data.success,\n            dataType: typeof response.data.data\n          });\n          if (response.data.success === true) {\n            const token = response.data.data;\n\n            // 验证token\n            if (typeof token === 'string' && token.length > 0) {\n              console.log('获取到有效token');\n\n              // 保存认证信息\n              localStorage.setItem('token', token);\n              localStorage.setItem('userId', userId.value);\n              ElMessage.success('登录成功');\n              router.push('/Index-Component');\n              return;\n            } else {\n              console.error('Token无效:', token);\n              ElMessage.error('登录失败：无效的认证信息');\n              return;\n            }\n          }\n        }\n\n        // 如果没有在上面返回，说明登录失败\n        console.error('登录失败，响应数据:', response.data);\n        ElMessage.error(response.data?.message || '登录失败，请检查用户名和密码');\n      } catch (error) {\n        // 详细的错误日志\n        console.error('登录异常:', {\n          name: error.name,\n          message: error.message,\n          config: error.config,\n          response: error.response ? {\n            status: error.response.status,\n            statusText: error.response.statusText,\n            data: error.response.data\n          } : 'No response',\n          stack: error.stack\n        });\n        if (error.response) {\n          switch (error.response.status) {\n            case 400:\n              ElMessage.error('请求参数错误');\n              break;\n            case 401:\n              ElMessage.error('用户名或密码错误');\n              break;\n            case 403:\n              ElMessage.error('没有访问权限');\n              break;\n            case 500:\n              ElMessage.error('服务器内部错误');\n              break;\n            default:\n              ElMessage.error(`登录失败 (${error.response.status})`);\n          }\n        } else if (error.request) {\n          ElMessage.error('无法连接到服务器，请检查网络');\n        } else {\n          ElMessage.error('登录请求失败：' + error.message);\n        }\n      }\n    };\n    const register = () => {\n      router.push('/Register-component');\n    };\n    const __returned__ = {\n      router,\n      userId,\n      password,\n      login,\n      register,\n      ref,\n      get axios() {\n        return axios;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      get ElForm() {\n        return ElForm;\n      },\n      get ElFormItem() {\n        return ElFormItem;\n      },\n      get ElInput() {\n        return ElInput;\n      },\n      get ElButton() {\n        return ElButton;\n      },\n      get ElMessage() {\n        return ElMessage;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","axios","useRouter","ElForm","ElFormItem","ElInput","ElButton","ElMessage","router","userId","password","login","value","error","console","log","response","method","url","data","headers","status","statusText","hasSuccess","hasMessage","hasData","successType","success","dataType","token","length","localStorage","setItem","push","message","name","config","stack","request","register"],"sources":["D:/IDEA/vue_elm/vue_elm/src/components/loginComponent.vue"],"sourcesContent":["<template>\n  <el-form class=\"wrapper\" @submit.prevent=\"login\">\n    <div class=\"header\">\n      <img :src=\"require('@/assets/img_1.png')\"\n           height=\"70px\"\n           width=\"100px\" alt=\"描述\"\n      />\n      <p>欢迎使用  饿了么</p>\n    </div>\n    <h>\n      <img :src=\"require('@/assets/elm_title.gif')\"\n           height=\"100%\"\n           width=\"100%\" alt=\"描述\"\n      />\n    </h>\n    <el-form-item label=\"账户:\">\n      <el-input v-model=\"userId\" placeholder=\"账户\"></el-input>\n    </el-form-item>\n    <el-form-item label=\"密码：\">\n      <el-input type=\"password\" v-model=\"password\" placeholder=\"密码\"></el-input>\n    </el-form-item>\n    <div class=\"button-box\">\n      <el-button type=\"primary\" @click=\"login\" style=\"width: 75%;margin-left: 25px;;margin-bottom: 10px; background-color: #409EFF;\">登录</el-button>\n    </div>\n    <div class=\"button-box\">\n      <el-button @click=\"register\" style=\"width: 75%;margin-left: 25px\">注册</el-button>\n    </div>\n\n  </el-form>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport axios from 'axios';\nimport { useRouter } from 'vue-router';\nimport { ElForm, ElFormItem, ElInput, ElButton, ElMessage } from 'element-plus';\n\nconst router = useRouter();\nconst userId = ref('');\nconst password = ref('');\n\nconst login = async () => {\n  try {\n    if (!userId.value || !password.value) {\n      ElMessage.error('请输入账号和密码');\n      return;\n    }\n\n    // 打印请求数据\n    console.log('发送登录请求:', {\n      userId: userId.value,\n      password: password.value\n    });\n\n    const response = await axios({\n      method: 'post',\n      url: 'http://localhost:8080/elm_servlet_war_exploded/login',\n      data: {\n        userId: userId.value,\n        password: password.value\n      },\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n\n    // 打印完整响应\n    console.log('收到响应:', {\n      status: response.status,\n      statusText: response.statusText,\n      headers: response.headers,\n      data: response.data\n    });\n\n    // 检查响应数据结构\n    if (response.data && typeof response.data === 'object') {\n      console.log('响应数据结构验证:', {\n        hasSuccess: 'success' in response.data,\n        hasMessage: 'message' in response.data,\n        hasData: 'data' in response.data,\n        successType: typeof response.data.success,\n        dataType: typeof response.data.data\n      });\n\n      if (response.data.success === true) {\n        const token = response.data.data;\n        \n        // 验证token\n        if (typeof token === 'string' && token.length > 0) {\n          console.log('获取到有效token');\n          \n          // 保存认证信息\n          localStorage.setItem('token', token);\n          localStorage.setItem('userId', userId.value);\n          \n          ElMessage.success('登录成功');\n          router.push('/Index-Component');\n          return;\n        } else {\n          console.error('Token无效:', token);\n          ElMessage.error('登录失败：无效的认证信息');\n          return;\n        }\n      }\n    }\n\n    // 如果没有在上面返回，说明登录失败\n    console.error('登录失败，响应数据:', response.data);\n    ElMessage.error(response.data?.message || '登录失败，请检查用户名和密码');\n\n  } catch (error) {\n    // 详细的错误日志\n    console.error('登录异常:', {\n      name: error.name,\n      message: error.message,\n      config: error.config,\n      response: error.response ? {\n        status: error.response.status,\n        statusText: error.response.statusText,\n        data: error.response.data\n      } : 'No response',\n      stack: error.stack\n    });\n\n    if (error.response) {\n      switch (error.response.status) {\n        case 400:\n          ElMessage.error('请求参数错误');\n          break;\n        case 401:\n          ElMessage.error('用户名或密码错误');\n          break;\n        case 403:\n          ElMessage.error('没有访问权限');\n          break;\n        case 500:\n          ElMessage.error('服务器内部错误');\n          break;\n        default:\n          ElMessage.error(`登录失败 (${error.response.status})`);\n      }\n    } else if (error.request) {\n      ElMessage.error('无法连接到服务器，请检查网络');\n    } else {\n      ElMessage.error('登录请求失败：' + error.message);\n    }\n  }\n};\n\nconst register = () => {\n  router.push('/Register-component');\n};\n\n</script>\n\n<style scoped>\n.wrapper {\n  width: 100%;\n  height: 100%;\n}\n\n/*顶部样式*/\n.button-box button:hover {\n  color: #17BAF9; /* 鼠标悬停时的背景色 */\n}\n\n.button-box button:active {\n  background-color: #288b52; /* 鼠标点击时的背景色 */\n}\n\n/*logo样式*/\n.wrapper .header {\n  width: 100%;\n  display: flex;\n  color: white;\n  align-items: center;\n  margin-left: 30px;\n\n\n}\n\n.wrapper .header p {\n  font-size: 5vw;\n  font-weight: bolder;\n  color: #17BAF9;\n}\n\n/*主体部分*/\n.wrapper .body .logins div {\n  display: flex;\n  box-sizing: border-box;\n  padding: 4vw 3vw 0 3vw;\n  align-items: center;\n}\n\n/* 定义输入框的基本样式 */\n.el-input__inner {\n  border: none; /* 移除输入框的边框 */\n  border-bottom: 2px solid #dcdfe6; /* 设置底部边框 */\n  border-radius: 0; /* 移除圆角 */\n  transition: border-color 0.3s; /* 平滑过渡效果 */\n}\n\n/* 定义输入框的 hover 状态 */\n.el-input__inner:hover {\n  border-color: #409EFF; /* 鼠标悬停时的边框颜色 */\n}\n\n/* 定义输入框的 focus 状态 */\n.el-input__inner:focus {\n  border-color: #409EFF; /* 输入框聚焦时的边框颜色 */\n  box-shadow: 0 0 5px rgba(64, 158, 255, 0.5); /* 添加阴影效果 */\n}\n\n.wrapper .body .logins div .content input {\n  border: none;\n  outline: none;\n  height: 6vw;\n  background-color: white;\n}\n\n.wrapper .body .button-box button {\n  font-size: 5vw;\n  width: 100%;\n  font-weight: 700;\n  color: white;\n  background-color: #38ca73;\n  border: none;\n  border-radius: 15px;\n  height: 10vw;\n}\n\n\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
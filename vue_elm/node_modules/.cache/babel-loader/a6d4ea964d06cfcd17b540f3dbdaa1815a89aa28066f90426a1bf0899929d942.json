{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  class: \"wrapper\"\n};\nconst _hoisted_2 = {\n  class: \"header\"\n};\nconst _hoisted_3 = {\n  class: \"search\"\n};\nconst _hoisted_4 = {\n  class: \"search-bottom\"\n};\nconst _hoisted_5 = {\n  class: \"search-pt\"\n};\nconst _hoisted_6 = {\n  class: \"information\"\n};\nconst _hoisted_7 = {\n  class: \"body\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"no-results\"\n};\nconst _hoisted_9 = {\n  class: \"order-header\"\n};\nconst _hoisted_10 = {\n  class: \"business-info\"\n};\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = {\n  class: \"business-details\"\n};\nconst _hoisted_13 = {\n  class: \"business-name\"\n};\nconst _hoisted_14 = {\n  class: \"delivery-price\"\n};\nconst _hoisted_15 = {\n  class: \"order-price\"\n};\nconst _hoisted_16 = {\n  class: \"order-content\"\n};\nconst _hoisted_17 = {\n  class: \"food-list\"\n};\nconst _hoisted_18 = {\n  class: \"food-left\"\n};\nconst _hoisted_19 = [\"src\"];\nconst _hoisted_20 = {\n  class: \"food-right\"\n};\nconst _hoisted_21 = {\n  class: \"food-name\"\n};\nconst _hoisted_22 = {\n  class: \"food-quantity\"\n};\nconst _hoisted_23 = {\n  class: \"order-footer\"\n};\nconst _hoisted_24 = {\n  class: \"order-date\"\n};\nconst _hoisted_25 = {\n  class: \"order-actions\"\n};\nconst _hoisted_26 = [\"onClick\"];\nconst _hoisted_27 = [\"onClick\"];\nconst _hoisted_28 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", {\n    class: \"back\"\n  }, [_createElementVNode(\"span\", {\n    class: \"iconfont icon-back\",\n    onClick: $setup.goBack\n  })]), _createElementVNode(\"div\", _hoisted_5, [_cache[7] || (_cache[7] = _createElementVNode(\"span\", {\n    class: \"iconfont icon-sousuo\",\n    style: {\n      \"margin-left\": \"2vw\"\n    }\n  }, null, -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    style: {\n      \"flex\": \"6\"\n    },\n    type: \"text\",\n    placeholder: \"ÂéÜÂè≤‰ø°ÊÅØÊêúÁ¥¢\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.searchQuery = $event),\n    onInput: $setup.handleSearch\n  }, null, 544 /* NEED_HYDRATION, NEED_PATCH */), [[_vModelText, $setup.searchQuery]]), $setup.searchQuery ? (_openBlock(), _createElementBlock(\"span\", {\n    key: 0,\n    class: \"clear-search\",\n    onClick: $setup.clearSearch\n  }, \" √ó \")) : _createCommentVNode(\"v-if\", true)]), _cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n    class: \"box\"\n  }, [_createElementVNode(\"span\", {\n    class: \"iconfont icon-gongjuxiang\"\n  }), _createElementVNode(\"span\", {\n    class: \"iconfont icon-24gf-ellipsis\"\n  })], -1 /* HOISTED */))]), _createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"p\", {\n    class: _normalizeClass({\n      active: $setup.activeTab === 'all'\n    }),\n    onClick: _cache[1] || (_cache[1] = $event => $setup.setActiveTab('all'))\n  }, \"ÂÖ®ÈÉ®\", 2 /* CLASS */), _createElementVNode(\"p\", {\n    class: _normalizeClass({\n      active: $setup.activeTab === 'inProgress'\n    }),\n    onClick: _cache[2] || (_cache[2] = $event => $setup.setActiveTab('inProgress'))\n  }, \"ËøõË°å‰∏≠\", 2 /* CLASS */), _createElementVNode(\"p\", {\n    class: _normalizeClass({\n      active: $setup.activeTab === 'toRate'\n    }),\n    onClick: _cache[3] || (_cache[3] = $event => $setup.setActiveTab('toRate'))\n  }, \"ÂæÖËØÑ‰ª∑\", 2 /* CLASS */), _createElementVNode(\"p\", {\n    class: _normalizeClass({\n      active: $setup.activeTab === 'rated'\n    }),\n    onClick: _cache[4] || (_cache[4] = $event => $setup.setActiveTab('rated'))\n  }, \"Â∑≤ËØÑ‰ª∑\", 2 /* CLASS */)])])]), _createElementVNode(\"div\", _hoisted_7, [$setup.filteredOrders.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, _cache[9] || (_cache[9] = [_createElementVNode(\"div\", {\n    class: \"no-results-icon\"\n  }, \"üîç\", -1 /* HOISTED */), _createElementVNode(\"div\", {\n    class: \"no-results-text\"\n  }, \"Ê≤°ÊúâÊâæÂà∞Áõ∏ÂÖ≥ËÆ¢Âçï\", -1 /* HOISTED */)]))) : _createCommentVNode(\"v-if\", true), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.filteredOrders, order => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: order.orderId,\n      class: \"order-card\"\n    }, [_createCommentVNode(\" ËÆ¢ÂçïÂ§¥ÈÉ®ÔºöÂïÜÂÆ∂‰ø°ÊÅØÂíåËÆ¢ÂçïÊÄª‰ª∑ \"), _createElementVNode(\"div\", _hoisted_9, [_createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"img\", {\n      src: $setup.getImageUrl(order.businessImg),\n      onError: _cache[5] || (_cache[5] = $event => $setup.handleImageError($event, 'business')),\n      class: \"business-img\"\n    }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_11), _createElementVNode(\"div\", _hoisted_12, [_createElementVNode(\"div\", _hoisted_13, _toDisplayString(order.businessName), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_14, _toDisplayString(order.deliveryPrice) + \"ÂÖÉÊó†Èó®Êßõ\", 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_15, \"¬•\" + _toDisplayString(order.orderTotal), 1 /* TEXT */)]), _createCommentVNode(\" ËÆ¢ÂçïÂÜÖÂÆπÔºöÈ£üÂìÅÂàóË°® \"), _createElementVNode(\"div\", _hoisted_16, [_createElementVNode(\"div\", _hoisted_17, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.getArrayFromString(order.foodNames), (foodName, index) => {\n      return _openBlock(), _createElementBlock(\"div\", {\n        key: index,\n        class: \"food-item\"\n      }, [_createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"img\", {\n        src: $setup.getFoodImage(order, index),\n        onError: _cache[6] || (_cache[6] = $event => $setup.handleImageError($event, 'food')),\n        class: \"food-img\",\n        alt: \"È£üÂìÅÂõæÁâá\",\n        loading: \"lazy\"\n      }, null, 40 /* PROPS, NEED_HYDRATION */, _hoisted_19)]), _createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"div\", _hoisted_21, _toDisplayString(foodName || 'Êú™Áü•È£üÂìÅ'), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_22, \"x\" + _toDisplayString($setup.getFoodQuantity(order, index)), 1 /* TEXT */)])]);\n    }), 128 /* KEYED_FRAGMENT */))])]), _createCommentVNode(\" ËÆ¢ÂçïÂ∫ïÈÉ®ÔºöËÆ¢ÂçïÊó∂Èó¥ÂíåÊìç‰ΩúÊåâÈíÆ \"), _createElementVNode(\"div\", _hoisted_23, [_createElementVNode(\"div\", _hoisted_24, _toDisplayString(order.orderDate), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_25, [_createElementVNode(\"button\", {\n      class: \"reorder-btn\",\n      onClick: $event => $setup.reorder(order)\n    }, \"ÂÜçÊù•‰∏ÄÂçï\", 8 /* PROPS */, _hoisted_26), $setup.isOrderRated(order.orderId) ? (_openBlock(), _createElementBlock(\"button\", {\n      key: 0,\n      class: \"rated-btn\",\n      onClick: $event => $setup.goToRating(order)\n    }, \" ‰øÆÊîπËØÑ‰ª∑ \", 8 /* PROPS */, _hoisted_27)) : (_openBlock(), _createElementBlock(\"button\", {\n      key: 1,\n      class: \"rating-btn\",\n      onClick: $event => $setup.goToRating(order)\n    }, \" ËØÑ‰ª∑ËÆ¢Âçï \", 8 /* PROPS */, _hoisted_28))])])]);\n  }), 128 /* KEYED_FRAGMENT */))])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","onClick","$setup","goBack","_hoisted_5","style","type","placeholder","_cache","$event","searchQuery","onInput","handleSearch","clearSearch","_createCommentVNode","_hoisted_6","_normalizeClass","active","activeTab","setActiveTab","_hoisted_7","filteredOrders","length","_hoisted_8","_Fragment","_renderList","order","orderId","_hoisted_9","_hoisted_10","src","getImageUrl","businessImg","onError","handleImageError","_hoisted_11","_hoisted_12","_hoisted_13","_toDisplayString","businessName","_hoisted_14","deliveryPrice","_hoisted_15","orderTotal","_hoisted_16","_hoisted_17","getArrayFromString","foodNames","foodName","index","_hoisted_18","getFoodImage","alt","loading","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","getFoodQuantity","_hoisted_23","_hoisted_24","orderDate","_hoisted_25","reorder","_hoisted_26","isOrderRated","goToRating","_hoisted_27","_hoisted_28"],"sources":["D:\\back_elm\\vue_elm\\src\\components\\historyComponent.vue"],"sourcesContent":["<template>\n  <div class=\"wrapper\">\n    <div class=\"header\">\n      <div class=\"search\">\n        <div class=\"search-bottom\">\n          <div class=\"back\">\n            <span class=\"iconfont icon-back\" @click=\"goBack\"></span>\n          </div>\n          <div class=\"search-pt\">\n            <span class=\"iconfont icon-sousuo\" style=\"margin-left: 2vw\"></span>\n            <input \n              style=\"flex:6;\" \n              type=\"text\" \n              placeholder=\"ÂéÜÂè≤‰ø°ÊÅØÊêúÁ¥¢\" \n              v-model=\"searchQuery\"\n              @input=\"handleSearch\"\n            />\n            <span \n              v-if=\"searchQuery\" \n              class=\"clear-search\" \n              @click=\"clearSearch\"\n            >\n              √ó\n            </span>\n          </div>\n          <div class=\"box\">\n            <span class=\"iconfont icon-gongjuxiang\"></span>\n            <span class=\"iconfont icon-24gf-ellipsis\"></span>\n          </div>\n        </div>\n        <div class=\"information\">\n          <p :class=\"{ active: activeTab === 'all' }\" @click=\"setActiveTab('all')\">ÂÖ®ÈÉ®</p>\n          <p :class=\"{ active: activeTab === 'inProgress' }\" @click=\"setActiveTab('inProgress')\">ËøõË°å‰∏≠</p>\n          <p :class=\"{ active: activeTab === 'toRate' }\" @click=\"setActiveTab('toRate')\">ÂæÖËØÑ‰ª∑</p>\n          <p :class=\"{ active: activeTab === 'rated' }\" @click=\"setActiveTab('rated')\">Â∑≤ËØÑ‰ª∑</p>\n        </div>\n      </div>\n    </div>\n    <div class=\"body\">\n      <div v-if=\"filteredOrders.length === 0\" class=\"no-results\">\n        <div class=\"no-results-icon\">üîç</div>\n        <div class=\"no-results-text\">Ê≤°ÊúâÊâæÂà∞Áõ∏ÂÖ≥ËÆ¢Âçï</div>\n      </div>\n      <div v-for=\"order in filteredOrders\" :key=\"order.orderId\" class=\"order-card\">\n        <!-- ËÆ¢ÂçïÂ§¥ÈÉ®ÔºöÂïÜÂÆ∂‰ø°ÊÅØÂíåËÆ¢ÂçïÊÄª‰ª∑ -->\n        <div class=\"order-header\">\n          <div class=\"business-info\">\n            <img :src=\"getImageUrl(order.businessImg)\" @error=\"handleImageError($event, 'business')\" class=\"business-img\"/>\n            <div class=\"business-details\">\n              <div class=\"business-name\">{{ order.businessName }}</div>\n              <div class=\"delivery-price\">{{ order.deliveryPrice }}ÂÖÉÊó†Èó®Êßõ</div>\n            </div>\n          </div>\n          <div class=\"order-price\">&#165;{{ order.orderTotal }}</div>\n        </div>\n        \n        <!-- ËÆ¢ÂçïÂÜÖÂÆπÔºöÈ£üÂìÅÂàóË°® -->\n        <div class=\"order-content\">\n          <div class=\"food-list\">\n            <div v-for=\"(foodName, index) in getArrayFromString(order.foodNames)\" :key=\"index\" class=\"food-item\">\n              <div class=\"food-left\">\n                <img \n                  :src=\"getFoodImage(order, index)\" \n                  @error=\"handleImageError($event, 'food')\" \n                  class=\"food-img\"\n                  alt=\"È£üÂìÅÂõæÁâá\"\n                  loading=\"lazy\"\n                />\n              </div>\n              <div class=\"food-right\">\n                <div class=\"food-name\">{{ foodName || 'Êú™Áü•È£üÂìÅ' }}</div>\n                <div class=\"food-quantity\">x{{ getFoodQuantity(order, index) }}</div>\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        <!-- ËÆ¢ÂçïÂ∫ïÈÉ®ÔºöËÆ¢ÂçïÊó∂Èó¥ÂíåÊìç‰ΩúÊåâÈíÆ -->\n        <div class=\"order-footer\">\n          <div class=\"order-date\">{{ order.orderDate }}</div>\n          <div class=\"order-actions\">\n            <button class=\"reorder-btn\" @click=\"reorder(order)\">ÂÜçÊù•‰∏ÄÂçï</button>\n            <button \n              v-if=\"isOrderRated(order.orderId)\" \n              class=\"rated-btn\" \n              @click=\"goToRating(order)\"\n            >\n              ‰øÆÊîπËØÑ‰ª∑\n            </button>\n            <button \n              v-else \n              class=\"rating-btn\" \n              @click=\"goToRating(order)\"\n            >\n              ËØÑ‰ª∑ËÆ¢Âçï\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed, watch } from 'vue';\nimport { useRouter } from 'vue-router';\nimport { orderApi } from '../utils/api';\nimport { businessApi } from '../utils/api'; // Added import for businessApi\nimport { ElMessage } from 'element-plus'; // Added ElMessage import\n\nconst router = useRouter();\nconst orders = ref([]);\nconst activeTab = ref('all');\nconst baseURL = 'http://localhost:8090'; // APIÁΩëÂÖ≥Âú∞ÂùÄ\nconst searchQuery = ref(''); // ÊêúÁ¥¢Êü•ËØ¢\nconst searchResults = ref([]); // ÊêúÁ¥¢ÁªìÊûú\n\nonMounted(() => {\n  fetchOrders();\n});\n\nconst goBack = () => {\n  router.push('/Index-Component');\n};\n\nconst setActiveTab = (tab) => {\n  activeTab.value = tab;\n  // ÂàáÊç¢Ê†áÁ≠æÊó∂ÊªöÂä®Âà∞È°∂ÈÉ®\n  window.scrollTo(0, 0);\n};\n\n// Ê∏ÖÈô§ÊêúÁ¥¢\nconst clearSearch = () => {\n  searchQuery.value = '';\n  searchResults.value = [];\n};\n\n// Â§ÑÁêÜÊêúÁ¥¢\nconst handleSearch = () => {\n  const query = searchQuery.value.trim().toLowerCase();\n  \n  if (!query) {\n    searchResults.value = [];\n    return;\n  }\n  \n  // Âú®ËÆ¢Âçï‰∏≠ÊêúÁ¥¢\n  searchResults.value = orders.value.filter(order => {\n    // ÊêúÁ¥¢ÂïÜÂÆ∂ÂêçÁß∞\n    if (order.businessName && order.businessName.toLowerCase().includes(query)) {\n      return true;\n    }\n    \n    // ÊêúÁ¥¢È£üÂìÅÂêçÁß∞\n    if (order.foodNames) {\n      const foodNames = getArrayFromString(order.foodNames);\n      if (foodNames.some(name => name.toLowerCase().includes(query))) {\n        return true;\n      }\n    }\n    \n    // ÊêúÁ¥¢ËÆ¢ÂçïÊó•Êúü\n    if (order.orderDate && order.orderDate.includes(query)) {\n      return true;\n    }\n    \n    // ÊêúÁ¥¢ËÆ¢ÂçïÈáëÈ¢ù\n    if (order.orderTotal && order.orderTotal.toString().includes(query)) {\n      return true;\n    }\n    \n    // ÊêúÁ¥¢ËÆ¢ÂçïÁä∂ÊÄÅ\n    const orderStateMap = {\n      'ÂæÖ‰ªòÊ¨æ': 1,\n      'ÂæÖÊé•Âçï': 2,\n      'ÈÖçÈÄÅ‰∏≠': 3,\n      'Â∑≤ÂÆåÊàê': 5,\n      'ÂæÖËØÑ‰ª∑': 5,\n      'Â∑≤ÈÄÄÊ¨æ': 6\n    };\n    \n    if (Object.keys(orderStateMap).some(key => \n      key.includes(query) && orderStateMap[key] === order.orderState\n    )) {\n      return true;\n    }\n    \n    return false;\n  });\n};\n\n// ÁõëÂê¨ÊêúÁ¥¢Êü•ËØ¢ÂèòÂåñ\nwatch(searchQuery, (newVal) => {\n  if (!newVal.trim()) {\n    searchResults.value = [];\n  } else {\n    handleSearch();\n  }\n});\n\n// Â∞ÜÈÄóÂè∑ÂàÜÈöîÁöÑÂ≠óÁ¨¶‰∏≤ËΩ¨Êç¢‰∏∫Êï∞ÁªÑ\nconst getArrayFromString = (str) => {\n  if (!str) return [];\n  \n  try {\n    // Ê£ÄÊü•ÊòØÂê¶ÊòØBase64Â≠óÁ¨¶‰∏≤ÈõÜÂêà\n    if (typeof str === 'string' && str.includes('data:image')) {\n      // Â∞ùËØïÊâæÂà∞ÊâÄÊúâÁöÑBase64ÂõæÁâá\n      const matches = str.match(/data:image\\/[^;]+;base64,[A-Za-z0-9+/=]+/g);\n      if (matches && matches.length > 0) {\n        console.log(`ÊâæÂà∞ ${matches.length} ‰∏™ÂÆåÊï¥ÁöÑBase64ÂõæÁâá`);\n        return matches;\n      }\n    }\n    \n    // Ê£ÄÊü•ÊòØÂê¶ÂåÖÂê´Â§ö‰∏™iVBORÂºÄÂ§¥ÁöÑBase64ÂõæÁâá\n    if (typeof str === 'string' && str.includes('iVBOR')) {\n      // Â∞ùËØïÂàÜÂâ≤Â§ö‰∏™Base64Â≠óÁ¨¶‰∏≤\n      const parts = [];\n      let currentIndex = 0;\n      \n      while (currentIndex < str.length) {\n        const iVBORIndex = str.indexOf('iVBOR', currentIndex);\n        if (iVBORIndex === -1) break;\n        \n        // ÊâæÂà∞‰∏ã‰∏Ä‰∏™iVBORÊàñÂ≠óÁ¨¶‰∏≤ÁªìÊùü\n        let nextIndex = str.indexOf('iVBOR', iVBORIndex + 5);\n        if (nextIndex === -1) nextIndex = str.length;\n        \n        // ÊèêÂèñËøôÊÆµBase64Êï∞ÊçÆ\n        const base64Part = str.substring(iVBORIndex, nextIndex).trim();\n        if (base64Part.length > 100) {  // Á°Æ‰øùÊòØÊúâÊïàÁöÑBase64Êï∞ÊçÆ\n          parts.push(base64Part);\n        }\n        \n        currentIndex = nextIndex;\n      }\n      \n      if (parts.length > 0) {\n        console.log(`ÊâæÂà∞ ${parts.length} ‰∏™iVBORÂºÄÂ§¥ÁöÑBase64ÂõæÁâá`);\n        return parts;\n      }\n    }\n    \n    // Â¶ÇÊûú‰∏çÊòØÁâπÊÆäÁöÑBase64ÈõÜÂêàÔºåÂàôÊåâÁÖßÂ∏∏ËßÑÊñπÂºèÂ§ÑÁêÜ\n    // È¶ñÂÖàÊ£ÄÊü•ÊòØÂê¶ÊòØÂçï‰∏™Base64Â≠óÁ¨¶‰∏≤\n    if (typeof str === 'string' && str.length > 100 && \n        (str.startsWith('data:image') || str.startsWith('iVBOR') || \n         /^[A-Za-z0-9+/=]+$/.test(str.substring(0, 20)))) {\n      return [str];\n    }\n    \n    // Â∞ùËØïÊåâÈÄóÂè∑ÂàÜÂâ≤Ôºå‰ΩÜÈúÄË¶ÅÊ≥®ÊÑè‰∏çË¶ÅÂàÜÂâ≤Base64Â≠óÁ¨¶‰∏≤‰∏≠ÁöÑÈÄóÂè∑\n    const items = [];\n    const commaPositions = [];\n    \n    // ÊâæÂá∫ÊâÄÊúâÂèØËÉΩÁöÑÈÄóÂè∑‰ΩçÁΩÆ\n    for (let i = 0; i < str.length; i++) {\n      if (str[i] === ',') {\n        commaPositions.push(i);\n      }\n    }\n    \n    // Ê£ÄÊü•ÊØè‰∏™ÈÄóÂè∑ÊòØÂê¶Âú®Base64Â≠óÁ¨¶‰∏≤ÂÜÖÈÉ®\n    let startPos = 0;\n    for (const pos of commaPositions) {\n      // Ê£ÄÊü•ÈÄóÂè∑ÂâçÂêéÁöÑÂ≠óÁ¨¶ÔºåÂà§Êñ≠ÊòØÂê¶ÊòØBase64ÂÜÖÈÉ®ÁöÑÈÄóÂè∑\n      const beforeComma = str.substring(Math.max(0, pos - 20), pos);\n      const afterComma = str.substring(pos + 1, Math.min(str.length, pos + 21));\n      \n      // Â¶ÇÊûúÈÄóÂè∑ÂâçÂêéÈÉΩÊòØBase64Â≠óÁ¨¶ÔºåÂàôÂèØËÉΩÊòØBase64ÂÜÖÈÉ®ÁöÑÈÄóÂè∑\n      const isBase64Comma = /^[A-Za-z0-9+/=]+$/.test(beforeComma) && \n                           /^[A-Za-z0-9+/=]+$/.test(afterComma);\n      \n      if (!isBase64Comma) {\n        // ËøôÊòØ‰∏Ä‰∏™ÊúâÊïàÁöÑÂàÜÈöîÈÄóÂè∑\n        const item = str.substring(startPos, pos).trim();\n        if (item) items.push(item);\n        startPos = pos + 1;\n      }\n    }\n    \n    // Ê∑ªÂä†ÊúÄÂêé‰∏ÄÈ°π\n    const lastItem = str.substring(startPos).trim();\n    if (lastItem) items.push(lastItem);\n    \n    // Â¶ÇÊûúÊ≤°ÊúâÊàêÂäüÂàÜÂâ≤ÔºåÂõûÈÄÄÂà∞ÁÆÄÂçïÁöÑÈÄóÂè∑ÂàÜÂâ≤\n    if (items.length === 0) {\n      return str.split(',').map(item => item.trim());\n    }\n    \n    return items;\n  } catch (error) {\n    console.error('ÂàÜÂâ≤Â≠óÁ¨¶‰∏≤Âá∫Èîô:', error);\n    // Âá∫ÈîôÊó∂Â∞ùËØïÁÆÄÂçïÁöÑÈÄóÂè∑ÂàÜÂâ≤\n    try {\n      return str.split(',').map(item => item.trim());\n    } catch {\n      return [str]; // ÊúÄÂêéÁöÑÂõûÈÄÄÊñπÊ°à\n    }\n  }\n};\n\n// Â§ÑÁêÜÂõæÁâáURL\nconst getImageUrl = (imgPath) => {\n  if (!imgPath) {\n    return require('@/assets/img/BUSINESS/img.png');\n  }\n  \n  try {\n    // Â¶ÇÊûúÊòØBase64ÁºñÁ†ÅÁöÑÂõæÁâáÊï∞ÊçÆ\n    if (typeof imgPath === 'string' && imgPath.length > 100) {\n      return sanitizeBase64(imgPath);\n    }\n    \n    // Â¶ÇÊûúÊòØÂÆåÊï¥URLÔºåÁõ¥Êé•ËøîÂõû\n    if (imgPath.startsWith('http')) {\n      return imgPath;\n    }\n    \n    // Â¶ÇÊûúÊòØ‰ª•/assetsÂºÄÂ§¥ÁöÑË∑ØÂæÑÔºåËΩ¨Êç¢‰∏∫Ê≠£Á°ÆÁöÑË∑ØÂæÑ\n    if (imgPath.startsWith('/assets/')) {\n      // ÂéªÊéâÂºÄÂ§¥ÁöÑ/assets/ÔºåÂõ†‰∏∫Âú®È°πÁõÆ‰∏≠assetsÊòØÁõ∏ÂØπË∑ØÂæÑ\n      const relativePath = imgPath.replace('/assets/', '');\n      try {\n        return require(`@/assets/${relativePath}`);\n      } catch (e) {\n        // Â∞ùËØïÈÄöËøáAPIÁΩëÂÖ≥Ëé∑Âèñ\n        return baseURL + imgPath;\n      }\n    }\n    \n    // Â¶ÇÊûúÊòØÁõ∏ÂØπË∑ØÂæÑÔºåÊ∑ªÂä†baseURL\n    if (imgPath.startsWith('/')) {\n      return baseURL + imgPath;\n    }\n    \n    // Â∞ùËØïÂä†ËΩΩÈ°πÁõÆ‰∏≠ÁöÑÂõæÁâá\n    try {\n      // È¶ñÂÖàÂ∞ùËØï‰ªéBUSINESSÁõÆÂΩïÂä†ËΩΩ\n      if (!imgPath.includes('/')) {\n        try {\n          return require('@/assets/img/BUSINESS/' + imgPath);\n        } catch (e) {\n          // Â∞ùËØï‰ªéÂÖ∂‰ªñÁõÆÂΩïÂä†ËΩΩ\n        }\n      }\n      \n      // ÁÑ∂ÂêéÂ∞ùËØï‰ªéÊôÆÈÄöimgÁõÆÂΩïÂä†ËΩΩ\n      return require('@/assets/img/' + imgPath);\n    } catch (e) {\n      return require('@/assets/img/BUSINESS/img.png');\n    }\n  } catch (error) {\n    console.error('Â§ÑÁêÜÂõæÁâáURLÂá∫Èîô:', error);\n    return require('@/assets/img/BUSINESS/img.png');\n  }\n};\n\n// Â§ÑÁêÜÂíåÈ™åËØÅBase64ÁºñÁ†ÅÁöÑÂõæÁâá\nconst sanitizeBase64 = (base64String) => {\n  try {\n    // Â∑≤ÁªèÊòØÂÆåÊï¥ÁöÑBase64Â≠óÁ¨¶‰∏≤\n    if (base64String.startsWith('data:image/')) {\n      return base64String;\n    }\n    \n    // Ê£ÄÊü•ÊòØÂê¶ÊòØPNGÁöÑBase64ÁºñÁ†Å\n    if (base64String.startsWith('iVBOR')) {\n      return `data:image/png;base64,${base64String}`;\n    }\n    \n    // Ê£ÄÊü•ÊòØÂê¶ÊòØJPEGÁöÑBase64ÁºñÁ†Å\n    if (base64String.startsWith('/9j/')) {\n      return `data:image/jpeg;base64,${base64String}`;\n    }\n    \n    // Ê£ÄÊü•ÊòØÂê¶ÂåÖÂê´Êó†ÊïàÂ≠óÁ¨¶\n    if (!/^[A-Za-z0-9+/=]+$/.test(base64String.replace(/\\s/g, ''))) {\n      console.warn('Base64Â≠óÁ¨¶‰∏≤ÂåÖÂê´Êó†ÊïàÂ≠óÁ¨¶');\n      return '';\n    }\n    \n    // Ê£ÄÊü•ÈïøÂ∫¶ÊòØÂê¶ÂêàÁêÜÔºàBase64ÁºñÁ†ÅÁöÑÂõæÁâáÈÄöÂ∏∏ÂæàÈïøÔºâ\n    if (base64String.length < 100) {\n      console.warn('Base64Â≠óÁ¨¶‰∏≤ÈïøÂ∫¶‰∏çË∂≥');\n      return '';\n    }\n    \n    // ÈªòËÆ§‰Ωú‰∏∫PNGÂ§ÑÁêÜ\n    return `data:image/png;base64,${base64String.replace(/\\s/g, '')}`;\n  } catch (error) {\n    console.error('Â§ÑÁêÜBase64Â≠óÁ¨¶‰∏≤Âá∫Èîô:', error);\n    return '';\n  }\n};\n\n// Â§ÑÁêÜÂõæÁâáÂä†ËΩΩÈîôËØØ\nconst handleImageError = (e, type) => {\n  console.error(`ÂõæÁâáÂä†ËΩΩÂ§±Ë¥•: ${e.target.src.substring(0, 50)}...`);\n  \n  try {\n    // Ê£ÄÊü•ÊòØÂê¶ÊòØBase64ÁºñÁ†ÅÁöÑÂõæÁâáÂä†ËΩΩÂ§±Ë¥•\n    const src = e.target.src;\n    if (src && src.startsWith('data:image')) {\n      console.log('Â∞ùËØï‰øÆÂ§çBase64ÂõæÁâá...');\n      \n      // ÊèêÂèñBase64ÈÉ®ÂàÜ\n      const base64Data = src.split(',')[1];\n      if (base64Data) {\n        // Â∞ùËØï‰ΩøÁî®‰∏çÂêåÁöÑMIMEÁ±ªÂûã\n        if (src.includes('image/png')) {\n          e.target.src = `data:image/jpeg;base64,${base64Data}`;\n          return;\n        } else if (src.includes('image/jpeg')) {\n          e.target.src = `data:image/png;base64,${base64Data}`;\n          return;\n        }\n      }\n    }\n  } catch (error) {\n    console.error('Â§ÑÁêÜÂõæÁâáÈîôËØØÊó∂Âá∫Èîô:', error);\n  }\n  \n  // ‰ΩøÁî®ÈªòËÆ§ÂõæÁâá\n  if (type === 'business') {\n    e.target.src = require('@/assets/img/BUSINESS/img.png');\n  } else {\n    e.target.src = require('@/assets/img/sp01.png');\n  }\n};\n\n// ÂÜçÊ¨°‰∏ãÂçï\nconst reorder = (order) => {\n  // ÂÆûÁé∞ÂÜçÊ¨°‰∏ãÂçïÂäüËÉΩ\n  router.push(`/business-component/${order.businessId}`);\n};\n\n// ÂâçÂæÄËØÑ‰ª∑È°µÈù¢\nconst goToRating = (order) => {\n  console.log('Order object:', order);\n  \n  // Á°Æ‰øùbusinessIdÂ≠òÂú®‰∏î‰∏∫ÊúâÊïàÂÄº\n  const businessId = order.businessId || order.business?.businessId || '1';\n  \n  // Â¶ÇÊûúÂïÜÂÆ∂ÂõæÁâá‰∏∫Á©∫ÔºåÂ∞ùËØïÂÜçÊ¨°Ëé∑Âèñ\n  if (!order.businessImg && businessId) {\n    businessApi.getBusinessById(businessId)\n      .then(businessInfo => {\n        if (businessInfo && businessInfo.businessImg) {\n          navigateToRating(order, businessInfo.businessImg);\n        } else {\n          navigateToRating(order);\n        }\n      })\n      .catch(error => {\n        console.error('Ëé∑ÂèñÂïÜÂÆ∂‰ø°ÊÅØÂ§±Ë¥•:', error);\n        navigateToRating(order);\n      });\n  } else {\n    navigateToRating(order);\n  }\n};\n\n// ÂØºËà™Âà∞ËØÑ‰ª∑È°µÈù¢\nconst navigateToRating = (order, businessImg = null) => {\n  router.push({\n    name: 'Rating',\n    params: {\n      orderId: order.orderId || '1',\n      businessId: order.businessId || order.business?.businessId || '1',\n      businessName: order.businessName || 'Êú™Áü•ÂïÜÂÆ∂'\n    },\n    query: {\n      businessImg: businessImg || order.businessImg || '',\n      orderDate: order.orderDate || ''\n    }\n  });\n};\n\n// Ê£ÄÊü•ËÆ¢ÂçïÊòØÂê¶Â∑≤ËØÑ‰ª∑\nconst isOrderRated = (orderId) => {\n  try {\n    // Ê£ÄÊü•Êú¨Âú∞Â≠òÂÇ®‰∏≠ÊòØÂê¶ÊúâËØ•ËÆ¢ÂçïÁöÑËØÑ‰ª∑\n    const ratingsString = localStorage.getItem('localRatings');\n    console.log(`Ê£ÄÊü•ËÆ¢Âçï ${orderId} ÊòØÂê¶Â∑≤ËØÑ‰ª∑, Êú¨Âú∞Â≠òÂÇ®:`, ratingsString);\n    \n    if (ratingsString) {\n      const ratings = JSON.parse(ratingsString);\n      console.log('Ëß£ÊûêÂêéÁöÑÊú¨Âú∞ËØÑ‰ª∑:', ratings);\n      \n      // Á°Æ‰øù‰ΩøÁî®Êï∞Â≠óÁ±ªÂûãËøõË°åÊØîËæÉ\n      const isRated = ratings.some(r => r.orderId === Number(orderId));\n      console.log(`ËÆ¢Âçï ${orderId} Â∑≤ËØÑ‰ª∑Áä∂ÊÄÅ:`, isRated);\n      return isRated;\n    }\n  } catch (error) {\n    console.error('Ê£ÄÊü•ËÆ¢ÂçïËØÑ‰ª∑Áä∂ÊÄÅÂ§±Ë¥•:', error);\n  }\n  return false;\n};\n\nconst fetchOrders = async () => {\n  try {\n    const response = await orderApi.getOrderHistory();\n    console.log('ËÆ¢ÂçïÂéÜÂè≤ÂéüÂßãÂìçÂ∫î:', response);\n    \n    if (response && Array.isArray(response)) {\n      orders.value = response;\n    } else if (response && response.data && Array.isArray(response.data)) {\n      orders.value = response.data;\n    } else if (response && typeof response === 'object') {\n      // Â∞ùËØï‰ªéÂìçÂ∫î‰∏≠ÊèêÂèñÊï∞ÊçÆ\n      console.log('Â∞ùËØï‰ªéÂìçÂ∫î‰∏≠ÊèêÂèñËÆ¢ÂçïÊï∞ÊçÆ:', response);\n      const possibleOrderArrays = [\n        response.data,\n        response.result,\n        response.content,\n        response.records,\n        response.list,\n        response.orders\n      ];\n      \n      for (const arr of possibleOrderArrays) {\n        if (arr && Array.isArray(arr)) {\n          console.log('ÊâæÂà∞ËÆ¢ÂçïÊï∞ÁªÑ:', arr);\n          orders.value = arr;\n          break;\n        }\n      }\n    }\n    \n    // ËØ¶ÁªÜËÆ∞ÂΩïÊØè‰∏™ËÆ¢ÂçïÁöÑÂõæÁâá‰ø°ÊÅØ\n    console.log('ËÆ¢ÂçïÊï∞ÊçÆÂ§ÑÁêÜÂâç:', JSON.stringify(orders.value.map(order => ({\n      orderId: order.orderId,\n      businessImg: order.businessImg ? order.businessImg.substring(0, 30) + '...' : 'null',\n      businessImgType: order.businessImg ? typeof order.businessImg : 'null',\n      hasBusinessImg: !!order.businessImg,\n      foodImgs: order.foodImgs ? order.foodImgs.substring(0, 30) + '...' : 'null',\n      foodImgsLength: order.foodImgs ? order.foodImgs.length : 0,\n      foodNames: order.foodNames,\n      foodNamesLength: order.foodNames ? order.foodNames.split(',').length : 0\n    }))));\n    \n    // Á°Æ‰øùÊØè‰∏™ËÆ¢ÂçïÂØπË±°ÈÉΩÊúâÂøÖË¶ÅÁöÑÂ±ûÊÄß\n    orders.value = orders.value.map(order => {\n      // ‰ΩøÁî®Êï∞ÊçÆÂ∫ì‰∏≠Â≠òÂÇ®ÁöÑÂïÜÂÆ∂ÂêçÁß∞ÂíåÂõæÁâá\n      const businessName = order.businessName || order.business?.businessName || 'Êú™Áü•ÂïÜÂÆ∂';\n      const businessImg = order.businessImg || order.business?.businessImg || '';\n      \n      // Â§ÑÁêÜÈ£üÂìÅÂõæÁâáÊï∞ÊçÆ\n      let foodImgs = order.foodImgs || '';\n      const foodNames = order.foodNames || '';\n      \n      // Ê£ÄÊü•È£üÂìÅÂêçÁß∞ÂíåÂõæÁâáÊï∞ÈáèÊòØÂê¶ÂåπÈÖç\n      const foodNamesArray = foodNames.split(',').filter(name => name.trim());\n      let foodImgsArray = getArrayFromString(foodImgs);\n      \n      console.log(`ËÆ¢Âçï ${order.orderId} ÁöÑÈ£üÂìÅÂêçÁß∞Êï∞Èáè: ${foodNamesArray.length}, È£üÂìÅÂõæÁâáÊï∞Èáè: ${foodImgsArray.length}`);\n      \n      // Â¶ÇÊûúÈ£üÂìÅÂõæÁâáÊï∞ÈáèÂ∞ë‰∫éÈ£üÂìÅÂêçÁß∞Êï∞ÈáèÔºåÊ∑ªÂä†ÈªòËÆ§ÂõæÁâá\n      if (foodImgsArray.length < foodNamesArray.length) {\n        console.log(`ËÆ¢Âçï ${order.orderId} ÁöÑÈ£üÂìÅÂõæÁâáÊï∞Èáè‰∏çË∂≥ÔºåÊ∑ªÂä†ÈªòËÆ§ÂõæÁâá`);\n        const defaultImg = '/assets/img/sp01.png';\n        while (foodImgsArray.length < foodNamesArray.length) {\n          foodImgsArray.push(defaultImg);\n        }\n        // ÈáçÊñ∞ÁîüÊàêfoodImgsÂ≠óÁ¨¶‰∏≤\n        foodImgs = foodImgsArray.join(',');\n      }\n      \n      // Â¶ÇÊûúÊúâËÆ¢ÂçïËØ¶ÊÉÖÔºåÂ∞ùËØï‰ªé‰∏≠ÊèêÂèñÊõ¥Â§öÂõæÁâá‰ø°ÊÅØ\n      if (order.orderDetailList && Array.isArray(order.orderDetailList)) {\n        const detailImages = order.orderDetailList.map(detail => detail.foodImg || '');\n        console.log(`ËÆ¢Âçï ${order.orderId} ÁöÑËØ¶ÊÉÖÂõæÁâá:`, detailImages);\n        \n        // Â¶ÇÊûúËØ¶ÊÉÖ‰∏≠ÁöÑÂõæÁâáÊØîfoodImgsÊõ¥Â§öÔºå‰ΩøÁî®ËØ¶ÊÉÖ‰∏≠ÁöÑÂõæÁâá\n        if (detailImages.filter(img => img).length > foodImgsArray.filter(img => img).length) {\n          foodImgs = detailImages.join(',');\n          console.log(`‰ΩøÁî®ËÆ¢ÂçïËØ¶ÊÉÖ‰∏≠ÁöÑÂõæÁâá:`, foodImgs.substring(0, 50) + '...');\n        }\n      }\n      \n      return {\n        ...order,\n        businessId: order.businessId || order.business?.businessId || '1',\n        businessName: businessName,\n        businessImg: businessImg,\n        foodImgs: foodImgs, // Êõ¥Êñ∞ÂêéÁöÑÈ£üÂìÅÂõæÁâá\n        orderDate: order.orderDate || new Date(order.orderTime || Date.now()).toLocaleString()\n      };\n    });\n    \n    console.log('Â§ÑÁêÜÂêéÁöÑËÆ¢ÂçïÊï∞ÊçÆ:', orders.value.map(order => ({\n      orderId: order.orderId,\n      foodImgsLength: order.foodImgs ? order.foodImgs.length : 0,\n      foodNamesLength: order.foodNames ? order.foodNames.split(',').length : 0\n    })));\n    \n  } catch (error) {\n    console.error('Ëé∑ÂèñËÆ¢ÂçïÂéÜÂè≤Â§±Ë¥•:', error);\n    \n    // Â¶ÇÊûúAPIË∞ÉÁî®Â§±Ë¥•ÔºåÂ∞ùËØï‰ªéÊú¨Âú∞Â≠òÂÇ®Ëé∑ÂèñËÆ¢Âçï‰ø°ÊÅØ\n    const localOrderInfo = localStorage.getItem('orderInfo');\n    if (localOrderInfo) {\n      try {\n        const orderInfo = JSON.parse(localOrderInfo);\n        console.log('‰ΩøÁî®Êú¨Âú∞Â≠òÂÇ®ÁöÑËÆ¢Âçï‰ø°ÊÅØ:', orderInfo);\n        \n        // ÂàõÂª∫Ê®°ÊãüËÆ¢ÂçïÊï∞ÊçÆ\n        const mockOrder = {\n          orderId: new Date().getTime(),\n          businessId: orderInfo.businessId,\n          businessName: orderInfo.businessName,\n          businessImg: orderInfo.businessImg,\n          orderDate: orderInfo.orderDate || new Date().toLocaleString(),\n          orderTotal: orderInfo.orderTotal || 0,\n          orderState: 5, // Â∑≤ÂÆåÊàê/ÂæÖËØÑ‰ª∑\n          foodNames: orderInfo.items?.map(item => item.foodName).join(','),\n          foodImgs: orderInfo.items?.map(item => item.foodImg || '/assets/img/sp01.png').join(','),\n          quantities: orderInfo.items?.map(item => item.quantity).join(',')\n        };\n        \n        // ‰ΩøÁî®Ê®°ÊãüÊï∞ÊçÆ\n        orders.value = [mockOrder];\n        \n        // ÊòæÁ§∫ÊèêÁ§∫\n        ElMessage({\n          message: 'APIÊúçÂä°‰∏çÂèØÁî®ÔºåÊòæÁ§∫Êú¨Âú∞Â≠òÂÇ®ÁöÑËÆ¢Âçï‰ø°ÊÅØ',\n          type: 'warning',\n          duration: 3000\n        });\n      } catch (e) {\n        console.error('Ëß£ÊûêÊú¨Âú∞ËÆ¢Âçï‰ø°ÊÅØÂ§±Ë¥•:', e);\n        \n        // ‰ΩøÁî®Á°¨ÁºñÁ†ÅÁöÑÊ®°ÊãüÊï∞ÊçÆ\n        useMockData();\n      }\n    } else {\n      // Â¶ÇÊûúÊú¨Âú∞Â≠òÂÇ®‰∏≠Ê≤°ÊúâËÆ¢Âçï‰ø°ÊÅØÔºå‰ΩøÁî®Á°¨ÁºñÁ†ÅÁöÑÊ®°ÊãüÊï∞ÊçÆ\n      useMockData();\n    }\n  }\n};\n\n// ‰ΩøÁî®Á°¨ÁºñÁ†ÅÁöÑÊ®°ÊãüÊï∞ÊçÆ\nconst useMockData = () => {\n  console.log('‰ΩøÁî®Á°¨ÁºñÁ†ÅÁöÑÊ®°ÊãüËÆ¢ÂçïÊï∞ÊçÆ');\n  \n  // ÂàõÂª∫Ê®°ÊãüËÆ¢ÂçïÊï∞ÊçÆ\n  const mockOrders = [\n    {\n      orderId: 1,\n      businessId: 1,\n      businessName: '‰∏áÂÆ∂È•∫Â≠êÔºàËΩØ‰ª∂Âõ≠E18Â∫óÔºâ',\n      businessImg: '/assets/img/BUSINESS/img.png',\n      orderDate: new Date().toLocaleString(),\n      orderTotal: 31,\n      orderState: 5,\n      foodNames: 'Á∫ØËÇâÈ≤úËÇâ,ÁéâÁ±≥È≤úËÇâ',\n      foodImgs: '/assets/img/sp01.png,/assets/img/sp01.png',\n      quantities: '1,1'\n    },\n    {\n      orderId: 2,\n      businessId: 2,\n      businessName: 'ËÇØÂæ∑Âü∫È∫¶ÂΩìÂä≥',\n      businessImg: '/assets/img/BUSINESS/img.png',\n      orderDate: new Date(Date.now() - 86400000).toLocaleString(), // Êò®Â§©\n      orderTotal: 45,\n      orderState: 5,\n      foodNames: 'Ê±âÂ†°,ËñØÊù°,ÂèØ‰πê',\n      foodImgs: '/assets/img/sp01.png,/assets/img/sp01.png,/assets/img/sp01.png',\n      quantities: '1,1,1'\n    }\n  ];\n  \n  // ‰ΩøÁî®Ê®°ÊãüÊï∞ÊçÆ\n  orders.value = mockOrders;\n  \n  // ÊòæÁ§∫ÊèêÁ§∫\n  ElMessage({\n    message: 'APIÊúçÂä°‰∏çÂèØÁî®ÔºåÊòæÁ§∫Ê®°ÊãüËÆ¢ÂçïÊï∞ÊçÆ',\n    type: 'warning',\n    duration: 3000\n  });\n};\n\n// Ê†πÊçÆÈÄâ‰∏≠ÁöÑÊ†áÁ≠æÂíåÊêúÁ¥¢ÁªìÊûúÁ≠õÈÄâËÆ¢Âçï\nconst filteredOrders = computed(() => {\n  // Â¶ÇÊûúÊúâÊêúÁ¥¢ÁªìÊûúÔºå‰ºòÂÖàÊòæÁ§∫ÊêúÁ¥¢ÁªìÊûú\n  if (searchQuery.value.trim() && searchResults.value.length > 0) {\n    // Ëøõ‰∏ÄÊ≠•Ê†πÊçÆÊ†áÁ≠æÁ≠õÈÄâÊêúÁ¥¢ÁªìÊûú\n    if (activeTab.value === 'all') {\n      return searchResults.value;\n    } else if (activeTab.value === 'inProgress') {\n      // ËÆ¢ÂçïÁä∂ÊÄÅÔºö1-Â∑≤‰∏ãÂçï/ÂæÖ‰ªòÊ¨æÔºå2-Â∑≤‰ªòÊ¨æ/ÂæÖÊé•ÂçïÔºå3-Â∑≤Êé•Âçï/ÈÖçÈÄÅ‰∏≠\n      return searchResults.value.filter(order => [1, 2, 3].includes(order.orderState));\n    } else if (activeTab.value === 'toRate') {\n      // Êú™ËØÑ‰ª∑ÁöÑËÆ¢Âçï\n      return searchResults.value.filter(order => \n        order.orderState === 5 && !isOrderRated(order.orderId)\n      );\n    } else if (activeTab.value === 'rated') {\n      // Â∑≤ËØÑ‰ª∑ÁöÑËÆ¢Âçï\n      return searchResults.value.filter(order => \n        isOrderRated(order.orderId)\n      );\n    }\n    return searchResults.value;\n  }\n  \n  // Â¶ÇÊûúÊ≤°ÊúâÊêúÁ¥¢ÊàñÊêúÁ¥¢ÁªìÊûú‰∏∫Á©∫Ôºå‰ΩøÁî®ÂéüÂßãÁ≠õÈÄâÈÄªËæë\n  if (activeTab.value === 'all') {\n    return orders.value;\n  } else if (activeTab.value === 'inProgress') {\n    // ËÆ¢ÂçïÁä∂ÊÄÅÔºö1-Â∑≤‰∏ãÂçï/ÂæÖ‰ªòÊ¨æÔºå2-Â∑≤‰ªòÊ¨æ/ÂæÖÊé•ÂçïÔºå3-Â∑≤Êé•Âçï/ÈÖçÈÄÅ‰∏≠\n    return orders.value.filter(order => [1, 2, 3].includes(order.orderState));\n  } else if (activeTab.value === 'toRate') {\n    // Êú™ËØÑ‰ª∑ÁöÑËÆ¢Âçï\n    return orders.value.filter(order => \n      order.orderState === 5 && !isOrderRated(order.orderId)\n    );\n  } else if (activeTab.value === 'rated') {\n    // Â∑≤ËØÑ‰ª∑ÁöÑËÆ¢Âçï\n    return orders.value.filter(order => \n      isOrderRated(order.orderId)\n    );\n  }\n  return orders.value;\n});\n\n// Ëé∑ÂèñÈ£üÂìÅÂõæÁâáÁöÑËæÖÂä©ÂáΩÊï∞\nconst getFoodImage = (order, index) => {\n  try {\n    // Ëé∑ÂèñÈ£üÂìÅÂõæÁâáÊï∞ÁªÑ\n    const foodImgs = getArrayFromString(order.foodImgs);\n    console.log(`Ëé∑ÂèñËÆ¢Âçï ${order.orderId} ÁöÑÁ¨¨ ${index} ‰∏™È£üÂìÅÂõæÁâá, ÂõæÁâáÊï∞ÁªÑÈïøÂ∫¶: ${foodImgs.length}`);\n    \n    // Ê£ÄÊü•Á¥¢ÂºïÊòØÂê¶ÊúâÊïà\n    if (index >= 0 && index < foodImgs.length) {\n      const imgPath = foodImgs[index];\n      console.log(`È£üÂìÅÂõæÁâáË∑ØÂæÑ: ${imgPath ? (imgPath.length > 50 ? imgPath.substring(0, 50) + '...' : imgPath) : 'null'}`);\n      \n      // Ê£ÄÊü•ÊòØÂê¶ÊòØBase64ÁºñÁ†Å\n      if (imgPath && imgPath.length > 100) {\n        return sanitizeBase64(imgPath);\n      }\n      \n      // Ê£ÄÊü•ÊòØÂê¶ÊòØÁ©∫Â≠óÁ¨¶‰∏≤ÊàñÊó†ÊïàË∑ØÂæÑ\n      if (!imgPath || imgPath === 'null' || imgPath === 'undefined') {\n        console.log('ÂõæÁâáË∑ØÂæÑÊó†ÊïàÔºåËøîÂõûÈªòËÆ§ÂõæÁâá');\n        return require('@/assets/img/sp01.png');\n      }\n      \n      // Â§ÑÁêÜÊôÆÈÄöÂõæÁâáURL\n      console.log('‰ΩøÁî®getImageUrlÂ§ÑÁêÜÊôÆÈÄöÂõæÁâáURL');\n      return getImageUrl(imgPath);\n    }\n    \n    // Â¶ÇÊûúÁ¥¢ÂºïÊó†ÊïàÔºåËøîÂõûÈªòËÆ§ÂõæÁâá\n    console.log('Á¥¢ÂºïÊó†ÊïàÔºåËøîÂõûÈªòËÆ§ÂõæÁâá');\n    return require('@/assets/img/sp01.png');\n  } catch (error) {\n    console.error('Ëé∑ÂèñÈ£üÂìÅÂõæÁâáÂá∫Èîô:', error, error.stack);\n    return require('@/assets/img/sp01.png');\n  }\n};\n\n// Ëé∑ÂèñÈ£üÂìÅÊï∞ÈáèÁöÑËæÖÂä©ÂáΩÊï∞\nconst getFoodQuantity = (order, index) => {\n  try {\n    // Ëé∑ÂèñÊï∞ÈáèÊï∞ÁªÑ\n    const quantities = getArrayFromString(order.quantities);\n    \n    // Ê£ÄÊü•Á¥¢ÂºïÊòØÂê¶ÊúâÊïà\n    if (index >= 0 && index < quantities.length) {\n      return quantities[index] || '1';\n    }\n    \n    // Â¶ÇÊûúÁ¥¢ÂºïÊó†ÊïàÔºåËøîÂõûÈªòËÆ§ÂÄº\n    return '1';\n  } catch (error) {\n    console.error('Ëé∑ÂèñÈ£üÂìÅÊï∞ÈáèÂá∫Èîô:', error);\n    return '1';\n  }\n};\n</script>\n\n<style scoped>\n.wrapper {\n  width: 100%;\n  height: 100%;\n  background-color: #f5f5f5;\n  padding-bottom: 20px;\n}\n\n.header {\n  background-color: white;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  width: 100%;\n  z-index: 10;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n.search-bottom {\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  height: 40px;\n}\n\n.back .icon-back {\n  font-size: 20px;\n  padding: 0 10px;\n}\n\n.search-pt {\n  flex: 1;\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.search-pt input {\n  width: 100%;\n  border: none;\n  background-color: #f5f5f5;\n  padding: 8px 8px 8px 30px;\n  border-radius: 20px;\n  font-size: 14px;\n}\n\n.search-pt .icon-sousuo {\n  position: absolute;\n  left: 10px;\n  font-size: 16px;\n  color: #999;\n}\n\n.box span {\n  padding: 0 10px;\n  font-size: 20px;\n}\n\n.information {\n  display: flex;\n  justify-content: space-around;\n  padding: 10px 0;\n  border-bottom: 1px solid #eee;\n}\n\n.information p {\n  padding: 5px 10px;\n  cursor: pointer;\n  position: relative;\n}\n\n.information p.active {\n  color: #0097ff;\n  font-weight: bold;\n}\n\n.information p.active::after {\n  content: '';\n  position: absolute;\n  bottom: -5px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 20px;\n  height: 3px;\n  background-color: #0097ff;\n  border-radius: 3px;\n}\n\n.body {\n  margin-top: 100px;\n  padding: 10px;\n}\n\n.order-card {\n  background-color: white;\n  border-radius: 10px;\n  margin-bottom: 15px;\n  padding: 15px;\n  box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n}\n\n.order-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-bottom: 10px;\n  border-bottom: 1px solid #f0f0f0;\n}\n\n.business-info {\n  display: flex;\n  align-items: center;\n}\n\n.business-img {\n  width: 50px;\n  height: 50px;\n  border-radius: 5px;\n  object-fit: cover;\n  margin-right: 10px;\n}\n\n.business-details {\n  display: flex;\n  flex-direction: column;\n}\n\n.business-name {\n  font-weight: bold;\n  font-size: 16px;\n  margin-bottom: 5px;\n}\n\n.delivery-price {\n  font-size: 12px;\n  color: #ff6b01;\n  background-color: #fff5e6;\n  padding: 2px 5px;\n  border-radius: 3px;\n  display: inline-block;\n}\n\n.order-price {\n  font-size: 16px;\n  font-weight: bold;\n  color: #333;\n}\n\n.order-content {\n  padding: 10px 0;\n}\n\n.food-list {\n  display: flex;\n  flex-direction: column;\n}\n\n.food-item {\n  display: flex;\n  align-items: center;\n  margin-bottom: 10px;\n  background-color: #f9f9f9;\n  border-radius: 8px;\n  padding: 10px;\n}\n\n.food-left {\n  margin-right: 15px;\n}\n\n.food-img {\n  width: 60px;\n  height: 60px;\n  border-radius: 5px;\n  object-fit: cover;\n}\n\n.food-img-placeholder {\n  width: 60px;\n  height: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #f0f0f0;\n  border-radius: 5px;\n}\n\n.food-img-placeholder img {\n  width: 30px;\n  height: 30px;\n}\n\n.food-right {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n}\n\n.food-name {\n  font-size: 14px;\n  font-weight: 500;\n  margin-bottom: 8px;\n}\n\n.food-quantity {\n  font-size: 12px;\n  color: #666;\n  background-color: #f0f0f0;\n  padding: 2px 8px;\n  border-radius: 12px;\n  display: inline-block;\n  width: fit-content;\n}\n\n.order-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 10px;\n  border-top: 1px solid #f0f0f0;\n}\n\n.order-date {\n  font-size: 12px;\n  color: #999;\n}\n\n.order-actions {\n  display: flex;\n  gap: 10px;\n}\n\n.reorder-btn, .rating-btn, .rated-btn {\n  border: none;\n  padding: 8px 15px;\n  border-radius: 20px;\n  font-size: 14px;\n  cursor: pointer;\n}\n\n.reorder-btn {\n  background-color: #0097ff;\n  color: white;\n}\n\n.rating-btn {\n  background-color: #ff6b01;\n  color: white;\n}\n\n.rated-btn {\n  background-color: #4caf50;\n  color: white;\n}\n\n.clear-search {\n  position: absolute;\n  right: 10px;\n  font-size: 18px;\n  color: #999;\n  cursor: pointer;\n  padding: 5px;\n}\n\n.no-results {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 50px 0;\n  color: #999;\n}\n\n.no-results-icon {\n  font-size: 50px;\n  margin-bottom: 10px;\n}\n\n.no-results-text {\n  font-size: 16px;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import axios from 'axios';\nimport { getToken, removeToken } from './auth';\n\n// 创建axios实例\nconst api = axios.create({\n  baseURL: 'http://localhost:8090',\n  // 通过API网关访问所有微服务\n  timeout: 10000,\n  // 增加超时时间\n  withCredentials: true,\n  // 允许携带凭证，确保Cookie可以被发送和接收\n  headers: {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json'\n  }\n});\n\n// 请求拦截器\napi.interceptors.request.use(config => {\n  const token = getToken();\n  console.log('发送请求前的token:', token);\n  if (token) {\n    config.headers['Authorization'] = `Bearer ${token}`;\n    console.log('请求头中的Authorization:', config.headers['Authorization']);\n  } else {\n    console.warn('Token不存在，请求可能会被拒绝');\n  }\n\n  // 添加CORS相关头\n  config.headers['Access-Control-Allow-Origin'] = 'http://localhost:8080';\n  console.log('完整的请求配置:', {\n    url: config.url,\n    method: config.method,\n    baseURL: config.baseURL,\n    headers: config.headers,\n    data: config.data,\n    withCredentials: config.withCredentials\n  });\n  return config;\n}, error => {\n  console.error('请求拦截器错误:', error);\n  return Promise.reject(error);\n});\n\n// 响应拦截器\napi.interceptors.response.use(response => {\n  console.log('收到响应:', response);\n  // 检查响应格式，确保返回正确的数据结构\n  if (response.data && response.data.code !== undefined) {\n    // 如果响应是标准的Result格式（包含code, msg, data）\n    return response.data;\n  }\n  // 否则直接返回响应数据\n  return response.data;\n}, error => {\n  console.error('响应错误:', error);\n  console.error('响应状态:', error.response?.status);\n  console.error('响应数据:', error.response?.data);\n  if (error.response?.status === 401) {\n    removeToken();\n    // 不在这里处理路由跳转，而是抛出特定的错误\n    error.isAuthError = true;\n  }\n  return Promise.reject(error);\n});\n\n// 用户相关API\nexport const userApi = {\n  login: data => api.post('/user/login', data),\n  register: data => api.post('/user/register', data),\n  getUserInfo: userId => api.get(`/user/${userId}`)\n};\n\n// 商家相关API\nexport const businessApi = {\n  getFoodList: businessId => api.get(`/business/${businessId}/foods`),\n  getBusinessInfo: businessId => api.get(`/business/${businessId}`),\n  getBusinessList: (page, size) => api.get(`/business/list?page=${page}&size=${size}`),\n  getBusinessById: businessId => api.get(`/business/getBusinessById/${businessId}`),\n  getFoodsByBusinessId: businessId => api.get(`/food/listByBusinessId/${businessId}`)\n};\n\n// 订单相关API\nexport const orderApi = {\n  createOrder: data => api.post('/orders/', data),\n  getOrderById: orderId => api.get(`/orders/${orderId}`),\n  getOrdersByUserId: userId => api.get(`/orders/user/${userId}`)\n};\n\n// 购物车相关API\nexport const cartApi = {\n  addToCart: data => api.post('/cart/', data),\n  getCartByUserId: userId => api.get(`/cart/user/${userId}`),\n  deleteCartItem: cartId => api.delete(`/cart/${cartId}`),\n  checkout: data => api.post('/cart/checkout', data),\n  getCart: userId => api.get(`/cart/${userId}`),\n  updateCart: data => api.put('/cart', data)\n};\n\n// 配送地址相关API\nexport const deliveryAddressApi = {\n  getDeliveryAddressesByUserId: userId => api.get(`/deliveryAddress/listByUserId/${userId}`),\n  addDeliveryAddress: data => api.post('/deliveryAddress/', data),\n  updateDeliveryAddress: data => api.put('/deliveryAddress/', data),\n  deleteDeliveryAddress: daId => api.delete(`/deliveryAddress/${daId}`)\n};\n\n// 支付相关API\nexport const paymentApi = {\n  processPayment: data => api.post('/payment/process', data),\n  verifyPayment: paymentId => api.get(`/payment/verify/${paymentId}`)\n};\n\n// 评价相关API\nexport const ratingApi = {\n  submitRating: data => api.post('/rating/', data),\n  getRatingsByBusinessId: businessId => api.get(`/rating/business/${businessId}`)\n};\nexport default api;","map":{"version":3,"names":["axios","getToken","removeToken","api","create","baseURL","timeout","withCredentials","headers","interceptors","request","use","config","token","console","log","warn","url","method","data","error","Promise","reject","response","code","undefined","status","isAuthError","userApi","login","post","register","getUserInfo","userId","get","businessApi","getFoodList","businessId","getBusinessInfo","getBusinessList","page","size","getBusinessById","getFoodsByBusinessId","orderApi","createOrder","getOrderById","orderId","getOrdersByUserId","cartApi","addToCart","getCartByUserId","deleteCartItem","cartId","delete","checkout","getCart","updateCart","put","deliveryAddressApi","getDeliveryAddressesByUserId","addDeliveryAddress","updateDeliveryAddress","deleteDeliveryAddress","daId","paymentApi","processPayment","verifyPayment","paymentId","ratingApi","submitRating","getRatingsByBusinessId"],"sources":["D:/back_elm/vue_elm/src/utils/api.js"],"sourcesContent":["import axios from 'axios';\nimport { getToken, removeToken } from './auth';\n\n// 创建axios实例\nconst api = axios.create({\n  baseURL: 'http://localhost:8090', // 通过API网关访问所有微服务\n  timeout: 10000, // 增加超时时间\n  withCredentials: true, // 允许携带凭证，确保Cookie可以被发送和接收\n  headers: {\n    'Content-Type': 'application/json',\n    'Accept': 'application/json'\n  }\n});\n\n// 请求拦截器\napi.interceptors.request.use(\n  config => {\n    const token = getToken();\n    console.log('发送请求前的token:', token);\n    \n    if (token) {\n      config.headers['Authorization'] = `Bearer ${token}`;\n      console.log('请求头中的Authorization:', config.headers['Authorization']);\n    } else {\n      console.warn('Token不存在，请求可能会被拒绝');\n    }\n    \n    // 添加CORS相关头\n    config.headers['Access-Control-Allow-Origin'] = 'http://localhost:8080';\n    \n    console.log('完整的请求配置:', {\n      url: config.url,\n      method: config.method,\n      baseURL: config.baseURL,\n      headers: config.headers,\n      data: config.data,\n      withCredentials: config.withCredentials\n    });\n    \n    return config;\n  },\n  error => {\n    console.error('请求拦截器错误:', error);\n    return Promise.reject(error);\n  }\n);\n\n// 响应拦截器\napi.interceptors.response.use(\n  response => {\n    console.log('收到响应:', response);\n    // 检查响应格式，确保返回正确的数据结构\n    if (response.data && response.data.code !== undefined) {\n      // 如果响应是标准的Result格式（包含code, msg, data）\n      return response.data;\n    }\n    // 否则直接返回响应数据\n    return response.data;\n  },\n  error => {\n    console.error('响应错误:', error);\n    console.error('响应状态:', error.response?.status);\n    console.error('响应数据:', error.response?.data);\n    \n    if (error.response?.status === 401) {\n      removeToken();\n      // 不在这里处理路由跳转，而是抛出特定的错误\n      error.isAuthError = true;\n    }\n    return Promise.reject(error);\n  }\n);\n\n// 用户相关API\nexport const userApi = {\n  login: (data) => api.post('/user/login', data),\n  register: (data) => api.post('/user/register', data),\n  getUserInfo: (userId) => api.get(`/user/${userId}`)\n};\n\n// 商家相关API\nexport const businessApi = {\n  getFoodList: (businessId) => api.get(`/business/${businessId}/foods`),\n  getBusinessInfo: (businessId) => api.get(`/business/${businessId}`),\n  getBusinessList: (page, size) => api.get(`/business/list?page=${page}&size=${size}`),\n  getBusinessById: (businessId) => api.get(`/business/getBusinessById/${businessId}`),\n  getFoodsByBusinessId: (businessId) => api.get(`/food/listByBusinessId/${businessId}`)\n};\n\n// 订单相关API\nexport const orderApi = {\n  createOrder: (data) => api.post('/orders/', data),\n  getOrderById: (orderId) => api.get(`/orders/${orderId}`),\n  getOrdersByUserId: (userId) => api.get(`/orders/user/${userId}`)\n};\n\n// 购物车相关API\nexport const cartApi = {\n  addToCart: (data) => api.post('/cart/', data),\n  getCartByUserId: (userId) => api.get(`/cart/user/${userId}`),\n  deleteCartItem: (cartId) => api.delete(`/cart/${cartId}`),\n  checkout: (data) => api.post('/cart/checkout', data),\n  getCart: (userId) => api.get(`/cart/${userId}`),\n  updateCart: (data) => api.put('/cart', data),\n};\n\n// 配送地址相关API\nexport const deliveryAddressApi = {\n  getDeliveryAddressesByUserId: (userId) => api.get(`/deliveryAddress/listByUserId/${userId}`),\n  addDeliveryAddress: (data) => api.post('/deliveryAddress/', data),\n  updateDeliveryAddress: (data) => api.put('/deliveryAddress/', data),\n  deleteDeliveryAddress: (daId) => api.delete(`/deliveryAddress/${daId}`)\n};\n\n// 支付相关API\nexport const paymentApi = {\n  processPayment: (data) => api.post('/payment/process', data),\n  verifyPayment: (paymentId) => api.get(`/payment/verify/${paymentId}`)\n};\n\n// 评价相关API\nexport const ratingApi = {\n  submitRating: (data) => api.post('/rating/', data),\n  getRatingsByBusinessId: (businessId) => api.get(`/rating/business/${businessId}`)\n};\n\nexport default api; "],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,EAAEC,WAAW,QAAQ,QAAQ;;AAE9C;AACA,MAAMC,GAAG,GAAGH,KAAK,CAACI,MAAM,CAAC;EACvBC,OAAO,EAAE,uBAAuB;EAAE;EAClCC,OAAO,EAAE,KAAK;EAAE;EAChBC,eAAe,EAAE,IAAI;EAAE;EACvBC,OAAO,EAAE;IACP,cAAc,EAAE,kBAAkB;IAClC,QAAQ,EAAE;EACZ;AACF,CAAC,CAAC;;AAEF;AACAL,GAAG,CAACM,YAAY,CAACC,OAAO,CAACC,GAAG,CAC1BC,MAAM,IAAI;EACR,MAAMC,KAAK,GAAGZ,QAAQ,CAAC,CAAC;EACxBa,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEF,KAAK,CAAC;EAElC,IAAIA,KAAK,EAAE;IACTD,MAAM,CAACJ,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUK,KAAK,EAAE;IACnDC,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEH,MAAM,CAACJ,OAAO,CAAC,eAAe,CAAC,CAAC;EACrE,CAAC,MAAM;IACLM,OAAO,CAACE,IAAI,CAAC,mBAAmB,CAAC;EACnC;;EAEA;EACAJ,MAAM,CAACJ,OAAO,CAAC,6BAA6B,CAAC,GAAG,uBAAuB;EAEvEM,OAAO,CAACC,GAAG,CAAC,UAAU,EAAE;IACtBE,GAAG,EAAEL,MAAM,CAACK,GAAG;IACfC,MAAM,EAAEN,MAAM,CAACM,MAAM;IACrBb,OAAO,EAAEO,MAAM,CAACP,OAAO;IACvBG,OAAO,EAAEI,MAAM,CAACJ,OAAO;IACvBW,IAAI,EAAEP,MAAM,CAACO,IAAI;IACjBZ,eAAe,EAAEK,MAAM,CAACL;EAC1B,CAAC,CAAC;EAEF,OAAOK,MAAM;AACf,CAAC,EACDQ,KAAK,IAAI;EACPN,OAAO,CAACM,KAAK,CAAC,UAAU,EAAEA,KAAK,CAAC;EAChC,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACAjB,GAAG,CAACM,YAAY,CAACc,QAAQ,CAACZ,GAAG,CAC3BY,QAAQ,IAAI;EACVT,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEQ,QAAQ,CAAC;EAC9B;EACA,IAAIA,QAAQ,CAACJ,IAAI,IAAII,QAAQ,CAACJ,IAAI,CAACK,IAAI,KAAKC,SAAS,EAAE;IACrD;IACA,OAAOF,QAAQ,CAACJ,IAAI;EACtB;EACA;EACA,OAAOI,QAAQ,CAACJ,IAAI;AACtB,CAAC,EACDC,KAAK,IAAI;EACPN,OAAO,CAACM,KAAK,CAAC,OAAO,EAAEA,KAAK,CAAC;EAC7BN,OAAO,CAACM,KAAK,CAAC,OAAO,EAAEA,KAAK,CAACG,QAAQ,EAAEG,MAAM,CAAC;EAC9CZ,OAAO,CAACM,KAAK,CAAC,OAAO,EAAEA,KAAK,CAACG,QAAQ,EAAEJ,IAAI,CAAC;EAE5C,IAAIC,KAAK,CAACG,QAAQ,EAAEG,MAAM,KAAK,GAAG,EAAE;IAClCxB,WAAW,CAAC,CAAC;IACb;IACAkB,KAAK,CAACO,WAAW,GAAG,IAAI;EAC1B;EACA,OAAON,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;AAC9B,CACF,CAAC;;AAED;AACA,OAAO,MAAMQ,OAAO,GAAG;EACrBC,KAAK,EAAGV,IAAI,IAAKhB,GAAG,CAAC2B,IAAI,CAAC,aAAa,EAAEX,IAAI,CAAC;EAC9CY,QAAQ,EAAGZ,IAAI,IAAKhB,GAAG,CAAC2B,IAAI,CAAC,gBAAgB,EAAEX,IAAI,CAAC;EACpDa,WAAW,EAAGC,MAAM,IAAK9B,GAAG,CAAC+B,GAAG,CAAC,SAASD,MAAM,EAAE;AACpD,CAAC;;AAED;AACA,OAAO,MAAME,WAAW,GAAG;EACzBC,WAAW,EAAGC,UAAU,IAAKlC,GAAG,CAAC+B,GAAG,CAAC,aAAaG,UAAU,QAAQ,CAAC;EACrEC,eAAe,EAAGD,UAAU,IAAKlC,GAAG,CAAC+B,GAAG,CAAC,aAAaG,UAAU,EAAE,CAAC;EACnEE,eAAe,EAAEA,CAACC,IAAI,EAAEC,IAAI,KAAKtC,GAAG,CAAC+B,GAAG,CAAC,uBAAuBM,IAAI,SAASC,IAAI,EAAE,CAAC;EACpFC,eAAe,EAAGL,UAAU,IAAKlC,GAAG,CAAC+B,GAAG,CAAC,6BAA6BG,UAAU,EAAE,CAAC;EACnFM,oBAAoB,EAAGN,UAAU,IAAKlC,GAAG,CAAC+B,GAAG,CAAC,0BAA0BG,UAAU,EAAE;AACtF,CAAC;;AAED;AACA,OAAO,MAAMO,QAAQ,GAAG;EACtBC,WAAW,EAAG1B,IAAI,IAAKhB,GAAG,CAAC2B,IAAI,CAAC,UAAU,EAAEX,IAAI,CAAC;EACjD2B,YAAY,EAAGC,OAAO,IAAK5C,GAAG,CAAC+B,GAAG,CAAC,WAAWa,OAAO,EAAE,CAAC;EACxDC,iBAAiB,EAAGf,MAAM,IAAK9B,GAAG,CAAC+B,GAAG,CAAC,gBAAgBD,MAAM,EAAE;AACjE,CAAC;;AAED;AACA,OAAO,MAAMgB,OAAO,GAAG;EACrBC,SAAS,EAAG/B,IAAI,IAAKhB,GAAG,CAAC2B,IAAI,CAAC,QAAQ,EAAEX,IAAI,CAAC;EAC7CgC,eAAe,EAAGlB,MAAM,IAAK9B,GAAG,CAAC+B,GAAG,CAAC,cAAcD,MAAM,EAAE,CAAC;EAC5DmB,cAAc,EAAGC,MAAM,IAAKlD,GAAG,CAACmD,MAAM,CAAC,SAASD,MAAM,EAAE,CAAC;EACzDE,QAAQ,EAAGpC,IAAI,IAAKhB,GAAG,CAAC2B,IAAI,CAAC,gBAAgB,EAAEX,IAAI,CAAC;EACpDqC,OAAO,EAAGvB,MAAM,IAAK9B,GAAG,CAAC+B,GAAG,CAAC,SAASD,MAAM,EAAE,CAAC;EAC/CwB,UAAU,EAAGtC,IAAI,IAAKhB,GAAG,CAACuD,GAAG,CAAC,OAAO,EAAEvC,IAAI;AAC7C,CAAC;;AAED;AACA,OAAO,MAAMwC,kBAAkB,GAAG;EAChCC,4BAA4B,EAAG3B,MAAM,IAAK9B,GAAG,CAAC+B,GAAG,CAAC,iCAAiCD,MAAM,EAAE,CAAC;EAC5F4B,kBAAkB,EAAG1C,IAAI,IAAKhB,GAAG,CAAC2B,IAAI,CAAC,mBAAmB,EAAEX,IAAI,CAAC;EACjE2C,qBAAqB,EAAG3C,IAAI,IAAKhB,GAAG,CAACuD,GAAG,CAAC,mBAAmB,EAAEvC,IAAI,CAAC;EACnE4C,qBAAqB,EAAGC,IAAI,IAAK7D,GAAG,CAACmD,MAAM,CAAC,oBAAoBU,IAAI,EAAE;AACxE,CAAC;;AAED;AACA,OAAO,MAAMC,UAAU,GAAG;EACxBC,cAAc,EAAG/C,IAAI,IAAKhB,GAAG,CAAC2B,IAAI,CAAC,kBAAkB,EAAEX,IAAI,CAAC;EAC5DgD,aAAa,EAAGC,SAAS,IAAKjE,GAAG,CAAC+B,GAAG,CAAC,mBAAmBkC,SAAS,EAAE;AACtE,CAAC;;AAED;AACA,OAAO,MAAMC,SAAS,GAAG;EACvBC,YAAY,EAAGnD,IAAI,IAAKhB,GAAG,CAAC2B,IAAI,CAAC,UAAU,EAAEX,IAAI,CAAC;EAClDoD,sBAAsB,EAAGlC,UAAU,IAAKlC,GAAG,CAAC+B,GAAG,CAAC,oBAAoBG,UAAU,EAAE;AAClF,CAAC;AAED,eAAelC,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}